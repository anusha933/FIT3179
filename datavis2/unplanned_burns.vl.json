{
   "$schema": "https://vega.github.io/schema/vega/v5.json",
  "background": "white",
  "padding": 5,
  "width": 800,
  "height": 400,

  "title": {
    "text": "Unplanned Burns in Australia (2019â€“2020)",
    "frame": "group"
  },

  "data": [
    {
      "name": "source_1",
      "url": "unplanned_burns.csv",
      "format": { "type": "csv" },
      "transform": [
        {
          "type": "formula",
          "as": "StateName",
          "expr": "datum.StateCode==='ACT' ? 'Australian Capital Territory' : datum.StateCode==='NSW' ? 'New South Wales' : datum.StateCode==='NT' ? 'Northern Territory' : datum.StateCode==='QLD' ? 'Queensland' : datum.StateCode==='SA' ? 'South Australia' : datum.StateCode==='TAS' ? 'Tasmania' : datum.StateCode==='VIC' ? 'Victoria' : datum.StateCode==='WA' ? 'Western Australia' : null"
        }
      ]
    },

    {
      "name": "aus_states",
      "url": "au-states-topo.json",
      "format": { "type": "json" },
      "transform": [
        {
          "type": "formula",
          "as": "STATE_NAME",
          "expr": "datum.properties && datum.properties.STATE_NAME"
        },

        {
          "type": "lookup",
          "from": "source_1",
          "key": "StateName",
          "fields": ["STATE_NAME"],
          "values": ["Burns", "Year"],
          "as": ["Burns", "Year"]
        },

        {
          "type": "filter",
          "expr": "datum.Year == '2019-2020'"
        }
      ]
    }
  ],

  "projections": [
    {
      "name": "projection",
      "type": "mercator",
      "center": [133, -28],
      "scale": 850
    }
  ],

  "scales": [
    {
      "name": "color",
      "type": "linear",
      "domain": { "data": "aus_states", "field": "Burns" },
      "nice": true,
      "zero": true,
      "range": { "scheme": "orangered" }
    }
  ],

  "marks": [
    {
      "type": "shape",
      "from": { "data": "aus_states" },
      "transform": [
        { "type": "geoshape", "projection": "projection" }
      ],
      "fill": [
        {
          "test": "isValid(datum.Burns) && isFinite(+datum.Burns)",
          "scale": "color",
          "field": "Burns"
        },
        { "value": "#f0f0f0" }
      ],
      "stroke": { "value": "white" },
      "strokeWidth": { "value": 0.5 },
      "tooltip": {
        "signal": "{'State': datum.STATE_NAME, 'Year': datum.Year, 'Burns': datum.Burns}"
      },
      "ariaRoleDescription": { "value": "geoshape" },
      "description": "Map of unplanned burns per state for 2019-2020"
    }
  ],

  "legends": [
    {
      "fill": "color",
      "title": "Unplanned Burns",
      "orient": "right",
      "labelOverlap": "greedy",
      "gradientLength": 150
    }
  ]
}
